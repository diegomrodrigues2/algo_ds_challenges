# ğŸ›¡ï¸ Propriedades de CorreÃ§Ã£o

## ğŸ¯ Conceito Central

Algoritmos de exclusÃ£o mÃºtua devem satisfazer trÃªs propriedades fundamentais: **mutual exclusion**, **deadlock-freedom** e **starvation-freedom**.

## ğŸ¨ Diagrama de Estados das Propriedades

```mermaid
stateDiagram-v2
    direction LR
    [*] --> Tentando
    
    state "SeÃ§Ã£o CrÃ­tica" as CS
    
    Tentando --> CS : lock() bem-sucedido
    
    CS --> [*] : unlock()

    state "Bloqueada" as Blocked
    
    Tentando --> Blocked : lock() bloqueia
    Blocked --> CS : Outra thread libera o lock
    
    state "ğŸ’€ Deadlock" as Dead
    Blocked --> Dead : âŒ ViolaÃ§Ã£o de Deadlock-Freedom
    
    state "ğŸ”¥ Starvation" as Starved
    Blocked --> Starved : âŒ ViolaÃ§Ã£o de Starvation-Freedom
```

## ğŸ¨ Diagrama de Deadlock (FilÃ³sofos ComilÃµes)

```mermaid
graph TD
    subgraph "Ciclo de Espera (Deadlock)"
        ThreadA("ğŸ‘¤ Thread A")
        ThreadB("ğŸ‘¤ Thread B")
        Lock1("ğŸ”’ Lock 1")
        Lock2("ğŸ”’ Lock 2")

        ThreadA -- possui --> Lock1
        ThreadB -- possui --> Lock2
        
        ThreadA --"espera por"--> Lock2
        ThreadB --"espera por"--> Lock1
    end

    style Lock1 fill:#f9f,stroke:#333,stroke-width:2px
    style Lock2 fill:#f9f,stroke:#333,stroke-width:2px
    linkStyle 2,3 stroke:red,stroke-width:2px,stroke-dasharray: 5 5;
```

## ğŸ“Š Propriedades Fundamentais

### ğŸ”’ Mutual Exclusion
**SeÃ§Ãµes crÃ­ticas de threads diferentes nÃ£o se sobrepÃµem**

```
Para threads A e B, e inteiros j e k:
CS_A^j â†’ CS_B^k OU CS_B^k â†’ CS_A^j
```

- âœ… **Safety property**: Garante correÃ§Ã£o dos resultados
- âŒ **Sem mutual exclusion**: Race conditions e resultados incorretos

### ğŸš« Deadlock-Freedom  
**Se alguma thread tenta adquirir o lock, alguma thread consegue**

```
Se thread A chama lock() mas nunca adquire:
â†’ Outras threads completam infinitas seÃ§Ãµes crÃ­ticas
```

- âœ… **Liveness property**: Sistema nunca "congela"
- âš ï¸ **Threads individuais**: Podem ficar presas (starvation)

### â­ Starvation-Freedom
**Toda thread que tenta adquirir o lock eventualmente consegue**

```
Toda chamada para lock() eventualmente retorna
```

- âœ… **Liveness property**: Garante progresso para todas as threads
- ğŸ”— **Implica deadlock-freedom**: Starvation-freedom â†’ Deadlock-freedom

## ğŸ¨ Diagrama de Starvation

```mermaid
sequenceDiagram
    participant ğŸ‘¤ Thread A
    participant ğŸ‘¤ Thread B
    participant ğŸ‘¤ Thread C
    participant ğŸ”’ Lock
    
    ğŸ‘¤ Thread A->>ğŸ”’ Lock: Adquire lock
    ğŸ‘¤ Thread A->>ğŸ”’ Lock: Libera lock
    ğŸ‘¤ Thread B->>ğŸ”’ Lock: Adquire lock
    ğŸ‘¤ Thread B->>ğŸ”’ Lock: Libera lock
    ğŸ‘¤ Thread A->>ğŸ”’ Lock: Adquire lock
    ğŸ‘¤ Thread A->>ğŸ”’ Lock: Libera lock
    Note over ğŸ‘¤ Thread C: ğŸ”¥ Starvation: Nunca consegue o lock
```

## ğŸ“‹ Hierarquia de Propriedades

| Propriedade | ForÃ§a | Garantia |
|-------------|-------|----------|
| **Mutual Exclusion** | ğŸ”´ Essencial | CorreÃ§Ã£o dos resultados |
| **Deadlock-Freedom** | ğŸŸ¡ Importante | Sistema nÃ£o congela |
| **Starvation-Freedom** | ğŸŸ¢ DesejÃ¡vel | Progresso para todas |

## âš¡ Exemplo: Deadlock com MÃºltiplos Locks

```java
// Thread A: lock0.lock() â†’ lock1.lock()
// Thread B: lock1.lock() â†’ lock0.lock()

// Resultado: Deadlock mesmo com locks deadlock-free
```

## ğŸ”§ AnÃ¡lise PrÃ¡tica

### âœ… Algoritmos PrÃ¡ticos
- **Starvation-free**: Garantia forte, mas overhead
- **Deadlock-free**: Compromisso entre correÃ§Ã£o e performance
- **Apenas mutual exclusion**: RÃ¡pido, mas pode causar starvation

### ğŸ“Š Trade-offs

| Aspecto | Starvation-Free | Deadlock-Free | Mutual Exclusion |
|---------|----------------|---------------|------------------|
| **CorreÃ§Ã£o** | âœ… MÃ¡xima | âœ… BÃ¡sica | âœ… BÃ¡sica |
| **Performance** | â° Overhead | ğŸš€ Moderado | ğŸš€ RÃ¡pido |
| **Fairness** | âœ… Garantida | âŒ NÃ£o garantida | âŒ NÃ£o garantida |
| **Complexidade** | ğŸ”¥ Alta | ğŸŸ¡ MÃ©dia | ğŸŸ¢ Baixa | 