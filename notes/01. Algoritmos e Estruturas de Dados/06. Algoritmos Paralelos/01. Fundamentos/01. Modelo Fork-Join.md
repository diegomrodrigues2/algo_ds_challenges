# ğŸ”„ Modelo Fork-Join

## ğŸ¯ Conceito Central
**Fork-join** Ã© o modelo mais bÃ¡sico e bem compreendido de algoritmos paralelos baseados em tarefas, permitindo expressar paralelismo de forma limpa usando extensÃµes linguÃ­sticas simples ao cÃ³digo serial.

## ğŸ”§ Palavras-Chave Paralelas

### ğŸ“¤ Spawn
```python
x = spawn P-FIB(n-1)  # Executa em paralelo
y = P-FIB(n-2)        # Continua executando
```
- **Fork**: Permite que uma subrotina execute em paralelo
- **Parent continua**: NÃ£o espera o child terminar
- **Cria Ã¡rvore**: SubcomputaÃ§Ãµes aninhadas em paralelo

### ğŸ”— Sync
```python
sync  # Espera todos os spawns terminarem
return x + y
```
- **Join**: SincronizaÃ§Ã£o explÃ­cita
- **Garante**: Valores dos children estÃ£o prontos
- **Implicit**: Todo return tem sync automÃ¡tico

### ğŸ”„ Parallel Loops
```python
parallel for i = 1 to n:
    # IteraÃ§Ãµes executam simultaneamente
```
- **IteraÃ§Ãµes paralelas**: MÃºltiplas iteraÃ§Ãµes simultÃ¢neas
- **Sem races**: Cada iteraÃ§Ã£o independente
- **Recursive spawning**: ImplementaÃ§Ã£o interna

## ğŸ“Š Modelo de ExecuÃ§Ã£o

### ğŸ•¸ï¸ Trace (DAG)
- **VÃ©rtices**: Strands (cadeias de instruÃ§Ãµes)
- **Arestas**: DependÃªncias entre strands
- **SÃ©rie**: Caminho direcionado entre strands
- **Paralelo**: Sem caminho entre strands

### ğŸ“ˆ MÃ©tricas de Performance

| MÃ©trica | DefiniÃ§Ã£o | FÃ³rmula |
|---------|-----------|---------|
| **Work (Tâ‚)** | Tempo total em 1 processador | Soma de todos os strands |
| **Span (Tâ‚)** | Tempo com âˆ processadores | Caminho crÃ­tico no DAG |
| **Parallelism** | RazÃ£o work/span | Tâ‚/Tâ‚ |

### ğŸ¯ Lei do Work e Span
```
Tâ‚š â‰¥ max(Tâ‚/P, Tâ‚)
```
- **Work Law**: Tâ‚š â‰¥ Tâ‚/P
- **Span Law**: Tâ‚š â‰¥ Tâ‚
- **Speedup**: Tâ‚/Tâ‚š â‰¤ P

## ğŸ§® AnÃ¡lise de Algoritmos

### ğŸ“ ComposiÃ§Ã£o SÃ©rie-Paralelo
| ComposiÃ§Ã£o | Work | Span |
|------------|------|------|
| **SÃ©rie** | Tâ‚(A) + Tâ‚(B) | Tâ‚(A) + Tâ‚(B) |
| **Paralelo** | Tâ‚(A) + Tâ‚(B) | max(Tâ‚(A), Tâ‚(B)) |

### ğŸ” Exemplo: P-FIB(n)
```python
def P-FIB(n):
    if n â‰¤ 1: return n
    x = spawn P-FIB(n-1)
    y = P-FIB(n-2)
    sync
    return x + y
```

**AnÃ¡lise:**
- **Work**: Tâ‚(n) = Î˜(Ï†â¿) (mesmo que serial)
- **Span**: Tâ‚(n) = Î˜(n) (recurrence: Tâ‚(n) = Tâ‚(n-1) + Î˜(1))
- **Parallelism**: Î˜(Ï†â¿/n) (cresce dramaticamente)

## ğŸ® Escalonamento

### ğŸ¯ Greedy Scheduler
- **Complete step**: P strands prontos â†’ usa todos os processadores
- **Incomplete step**: < P strands prontos â†’ alguns processadores ociosos

### ğŸ“Š Teorema do Greedy
```
Tâ‚š â‰¤ Tâ‚/P + Tâ‚
```
- **Fator 2**: Dentro de 2x do Ã³timo
- **Linear speedup**: Quando P â‰ª Tâ‚/Tâ‚
- **Slackness**: (Tâ‚/Tâ‚)/P > 1 para boa performance

## âš ï¸ Race Conditions

### ğŸ Determinacy Races
```python
# âŒ INCORRETO - Race condition
parallel for i = 1 to 2:
    x = x + 1  # Acesso concorrente Ã  mesma variÃ¡vel
```

### âœ… CÃ³digo DeterminÃ­stico
- **Mutualmente nÃ£o-interferentes**: Strands paralelos nÃ£o compartilham escrita
- **Apenas leitura**: Dados compartilhados sÃ³ para leitura
- **Sem races**: Comportamento determinÃ­stico garantido

## ğŸ¯ Vantagens do Modelo

| Aspecto | âœ… Vantagem |
|---------|-------------|
| **Simplicidade** | ExtensÃ£o natural do cÃ³digo serial |
| **AnÃ¡lise** | Work/span analysis matemÃ¡tica |
| **Escalabilidade** | Funciona em qualquer nÃºmero de processadores |
| **ImplementaÃ§Ã£o** | Suportado por frameworks modernos | 